type: object
description: reprime.yaml structure for LinkORB
required: [ name, description, type ]
additionalProperties: false
properties:
  $meta:
    type: object
    description: Repo-specific metadata

  name:
    type: string
    description: Repository name
    pattern: ^[a-z0-9-]+$
    minLength: 1
    maxLength: 50

  description:
    type: string
    description: Repository description
    minLength: 1
    maxLength: 100

  license:
    type: string
    description: Repository license
    default: mit

    enum:
    - mit
    - gpl-v3
    - proprietary

  visibility:
    type: string
    description: Repository visibility
    default: private
    enum:
    - public
    - private

  website:
    type: string
    description: URL with more information about of this repository
    default: https://engineering.linkorb.com

  codeowners:
    description: List of object that contain pattern and owner properties for CODEOWNERS file generation
    type: array
    items:
      type: object
      properties:
        pattern:
          type: string
          description: Glob-like pattern, eg. *.js
        owners:
          type: array
          description: GitHub usernames, enclosed within quotes, eg. "@github"
          items:
            type: string

  todo:
    type: array
    items:
      type: object
      properties:
        text:
          type: string
        state:
          type: string
          enum:
            - open
            - in-progress
            - closed

  envoi:
    type: object
    description: Envoi settings

  related:
    type: array
    description: Related repos

  fixtures:
    type: object
    description: Fixture settings

  github:
    type: object
    description: GitHub specific values
    additionalProperties: false
    properties:
      archived:
        type: boolean
        default: false
        description: is this repository archived?

      topics:
        type: array
        description: GitHub topics
        items:
          type: string
      features:
        type: object
        description: GitHub features
        additionalProperties: false
        properties:
          wiki:
            type: boolean
            default: false
          issues:
            type: boolean
            default: false

  type:
    type: string
    description: Repository type
    enum:
    - application
    - library
    - symfony-bundle
    - other
  php:
    type: object
    description: PHP specific values
    properties:
      private_packagist:
        type: boolean
        description: Determines whether setting up a repository requires Private packagist credentials
        default: false
  docker:
    type: object
    description: Docker specific values
  devcontainer:
    type: object
    description: Devcontainer specific values
    properties:
      repository:
        type: string
        default: ghcr.io/linkorb/php-docker-base
      tag:
        type: string
        default: php8-review
      run:
        type: array
        description: A list of additional commands to run during image build using the RUN directive
        items:
          type:
            command:
              type: string
              description: A command that may be passed directly to RUN or bash -c
            with_bash:
              type: boolean
              description: Whether to execute the command with BASH shell
              default: false
            as:
              type: string
              description: What user runs the command. E.g., root
              default: root
      apt:
        type: object
        description: A dictionary of apt package manager operations
        properties:
          install:
            type: array
            description: A list of additional apt packages to install in the Docker image
            items:
              type: string
      use_ansible:
        type: boolean
        description: Setup repo-ansible inside the image
        default: false
      features:
        type: object
        description: |
          Features to add to the dev container. E.g., `"ghcr.io/devcontainers/features/docker-in-docker:1": {}`. See https://containers.dev/features for a list of available devcontainer features.
      postCreateCommand:
        type: string
        description: The command that runs immediately after the is built but before the container starts.
  path:
    type: string
  phpqa:
    type: object
    description: phpqa tools specific values
    properties:
      phpstan:
        type: object
        properties:
          level:
            type: number
            description: phpstan level
            default: 0
          path:
            type: array
            description: Path to directories for phpstan
            default:
              - src
      php_fixer:
        type: object
        properties:
          path:
            type: array
            description: Path to directories for php-cs-fixer
      composer_unused:
        type: object
        properties:
          filtered_packages:
            type: array
            description: List of project specific packages that should be ignored by composer-unused (PHP regex)
          default_filtered_packages:
            type: array
            default:
              - /^ext-.*/
  security:
    type: object
    additionalProperties: false
    properties:
      email:
        type: string
        default: security@linkorb.com
        description: e-mail address for reporting security issues
      pgp-url:
        type: string
        default: https://engineering.linkorb.com/pgp-key
  readme:
    type: object
    properties:
      section:
        type: object
      usage:
        type: object
        properties:
          enabled:
            type: bool
            default: true
            description: README.md file generation
